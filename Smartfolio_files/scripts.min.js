angular.module("lrSiteApp",["lrSiteApp.directives","lrSiteApp.factories","lrSiteApp.services"]).run(["$http","dataService",function(e,t){t.init(),e.defaults.headers.common["X-Site-Id"]=function(){return t.getSiteId()},e.defaults.headers.common["X-Authorization"]=function(){return console.log(t.getLrApiKey()),t.getLrApiKey()}}]),angular.module("lrSiteApp.directives",[]),angular.module("lrSiteApp.factories",[]),angular.module("lrSiteApp.services",[]),angular.module("lrSiteApp.directives").directive("lrSite",function(){var e={controller:["$scope","trackingService",function(e,t){e.lrSiteIsLoaded=!0,t.start()}],link:function(e,t,i){console.log("lrSite initializing"),t.find("#site-loading").hide(),t.find("#site-blocks").show()}};return e}),angular.module("lrSiteApp.directives").directive("siteUserSignupBlock",["$http","dataService","shareLinkService","siteUserService","urlFactory",function(e,t,i,r,n){return{controller:["$scope","$element","dataService","shareLinkService","siteUserService","urlFactory",function(t,i,r,n,o,a){t.updateShareLink=function(){t.shareLink||n.getShareLink().success(function(e){t.shareLink=e,console.log(e)})},t.siteUserSignup={fullName:null,email:null,phone:null,referredBySiteUserId:r.getReferredBySiteUserId(),siteId:r.getSiteId()},t.submit=function(){t.form.$setSubmitted(!0),t.form.$invalid?alert("Some of the fields are invalid. Please check your information and try again."):(t.submitting=!0,e.post(a.createSiteUserUrl(),t.siteUserSignup).success(function(e){t.submitting=!1;var i=e.data,r=e.metadata.lrApiKey;o.authenticate(i,r).success(function(){t.updateShareLink()})}).error(function(e){t.submitting=!1,alert("An error occured on signup. Please try again."),console.log(e)}))},t.siteUser&&t.updateShareLink()}],link:function(e,t,i){}}}]),angular.module("lrSiteApp.directives").directive("socialShareButtons",["$window",function(e){return{controller:["$scope","$window","socialProviderFactory",function(e,t,i){e.getShareData=function(e){return{url:$(e).data("url"),text:$(e).data("text"),title:$(e).data("title"),image:$(e).data("image"),description:$(e).data("description")}},e.openShareWindow=function(r){var n=i.getProvider($(r).data("provider")),o=e.getShareData($(r).closest("ul")),a=500,s=500,c=screen.width/2-a/2,u=screen.height/2-s/2,l=n.url(o),d=n.name,p="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+s+", top="+u+", left="+c;t.open(l,d,p)}}],link:function(e,t,i){$(t).find("a").on("click",function(t){t.preventDefault(),e.openShareWindow(t.target)})}}}]),angular.module("lrSiteApp.factories").factory("socialProviderFactory",["dataService",function(e){return{getProvider:function(e){return this.getProviders()[e]},getProviders:function(){return{facebook:{name:"Facebook",url:function(e){return"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e.url)+"&p[title]="+encodeURIComponent(e.title)+"&p[summary]="+encodeURIComponent(e.description)},windowProperties:"resizable,scrollbars,status,height=300,width=500"},twitter:{name:"Twitter",url:function(t){var i=encodeURIComponent(t.text)+" "+encodeURIComponent(t.url);return i+=encodeURIComponent(e.getIsLaunchrockBrandingVisible()?" via @Launchrock":""),"https://twitter.com/intent/tweet?status="+i},windowProperties:"resizable,scrollbars,status,height=300,width=500"},linkedin:{name:"LinkedIn",url:function(e){return"https://www.linkedin.com/shareArticle?mini=true&title="+encodeURIComponent(e.title)+"&description="+encodeURIComponent(e.description)+"&summary="+encodeURIComponent(e.text)+"&url="+encodeURIComponent(e.url)},windowProperties:"resizable,scrollbars,status,height=300,width=500"},"google-plus":{name:"Google+",url:function(e){return"https://plus.google.com/share?url="+encodeURIComponent(e.url)},windowProperties:"resizable,scrollbars,status,height=300,width=500"},tumblr:{name:"Tumblr",url:function(e){return"http://www.tumblr.com/share?v=3&t="+encodeURIComponent(e.text)+"&u="+encodeURIComponent(e.url)},windowProperties:"resizable,scrollbars,status,height=300,width=500"}}}}}]),angular.module("lrSiteApp.factories").factory("urlFactory",["dataService",function(e){var t={authByLrApiKeyUrl:function(){return"/lr/auth/by-lr-api-key"},createSiteUserUrl:function(){var t=(e.getSiteId(),e.getApiEndpoint());return t+"/site-users/create"},trackViewUrl:function(){return"/lr/track/view"},trackPingUrl:function(){return"/lr/track/ping"}};return t}]),function(e,t,i,r){"use strict";var n=0,o=function(t,i){this.elem=t,this.$elem=e(t),this.options=i,this.instanceId="makeSameHeight-"+n,n++,this.metadata=this.$elem.data("plugin-options")};o.prototype={defaults:{targets:".site-block__col",minWidth:0},init:function(){return this.config=e.extend({},this.defaults,this.options,this.metadata),this.makeSameHeight(),this},makeSameHeight:function(){var r=this,n=function(i){var n=e(t).width(),o=(e(t).height(),0);n>=r.config.minWidth?(r.$elem.find(r.config.targets).each(function(){var t,i;e(this).height(""),t=e(this).height(),i=parseInt(e(this).css("padding-top"),10),o=t>o?t:o}),r.$elem.find(r.config.targets).each(function(){e(this).height(o)})):r.$elem.find(r.config.targets).each(function(){e(this).height("")})};n(),e(t).on("load."+this.instanceId,n),e(i).on("ready."+this.instanceId,n),e(t).on("resize."+this.instanceId,n)}},o.defaults=o.prototype.defaults,e.fn.makeSameHeight=function(e){return this.each(function(){new o(this,e).init()})}}(jQuery,window,document),$(".uniform-column-height").makeSameHeight(),angular.module("lrSiteApp.services").service("dataService",["$rootScope",function(e){var t={init:function(){lrSiteRenderingData?(e.renderingData=lrSiteRenderingData,e.shareLink=e.renderingData.shareLink,e.snapshot=e.renderingData.snapshot,e.siteUser=e.renderingData.siteUser,e.site=e.snapshot.site):angular.error("lrSiteRenderingData is undefined.")},getSiteRendingData:function(){return e.renderingData},getApiEndpoint:function(){return e.renderingData.apiEndpoint},getIsPreview:function(){return e.renderingData.isPreview},getReferredBySiteUserId:function(){return e.renderingData.referredBySiteUserId},getLaunchrockDiscoverUrl:function(){return e.renderingData.launchrockDiscoverurl},getLrApiKey:function(){return e.renderingData.lrApiKey},getSessionId:function(){return e.renderingData.sessionId},getSiteId:function(){return e.snapshot.site.siteId},getSiteDomain:function(){return e.snapshot.primaryDomain.fullDomain},getIsLaunchrockBrandingVisible:function(){return e.snapshot.site.isLaunchrockBrandingVisible}};return t}]),angular.module("lrSiteApp.services").service("shareLinkService",["$http","siteUserService",function(e,t){return{getShareLink:function(){return e.post("/lr/share-link/create",{})}}}]),angular.module("lrSiteApp.services").service("siteUserService",["$http","$rootScope","urlFactory","dataService",function(e,t,i,r){var n={getCurrentSiteUser:function(){return t.siteUser},submitSiteUser:function(t){return e.post(i.createSiteUserUrl(),t)},authenticate:function(r,n){return t.siteUser=r,e.post(i.authByLrApiKeyUrl(),{lrApiKey:n})}};return n}]),angular.module("lrSiteApp.services").service("trackingService",["$http","$timeout","urlFactory","dataService",function(e,t,i,r){var n={visitorId:null,sitePageViewId:null,start:function(){console.log("Tracking disabled.")},trackView:function(){var t={siteId:r.getSiteId()};return e.post(i.trackViewUrl(),t)},ping:function(){var t={visitorId:n.visitorId,sitePageViewId:n.sitePageViewId};return e.post(i.trackPingUrl(),t)}};return n}]);